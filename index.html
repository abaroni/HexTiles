<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <style>
    .controls{
      padding-top: 20px;
      padding-bottom: 50px;
      margin-left: 36px;
    }
    * {
          -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none; /* Safari */
             -khtml-user-select: none; /* Konqueror HTML */
               -moz-user-select: none; /* Firefox */
                -ms-user-select: none; /* Internet Explorer/Edge */
                    user-select: none; /* Non-prefixed version, currently
                                          supported by Chrome and Opera */
        }
    :root {
      --GESSO: #D7D4CD;
      --CANAPA: #C8C5BF;
      --CACAO: #79716F;
      --CENERE: #C6C6C6;
      --LAVAGNA: #7F8386;
    }
    .modal-body{
      padding-top: 40px;
    }
    .hexrow{
      font-size: 94px;
      margin-top: -78px;
      letter-spacing: -13px;
    }
    .hexrowEven{
        margin-left: 36px;
    }
    .hexrowOdd{
    }
  </style>
  <script>
    const COLUMNS = 5
    const ROWS = 4

    const GESSO = "var(--GESSO)"
    const CANAPA = "var(--CANAPA)"
    const CACAO = "var(--CACAO)"
    const CENERE = "var(--CENERE)"
    const LAVAGNA = "var(--LAVAGNA)"
    const COLORS = [GESSO,CANAPA,CACAO,CENERE,LAVAGNA]
    /***********************/
    const randomColor = function(){
      return randomColorFromSet(COLORS)
    }
    const randomColorFromSet = function(set){
      if (set.length == 0){
        console.error("randomColorFromSet for empty set - setting random color")
        return randomColor()
      }
      return set[Math.floor(Math.random()*set.length)]
    }
    function shuffle(array) {
      var currentIndex = array.length, temporaryValue, randomIndex;
      // While there remain elements to shuffle...
      while (0 !== currentIndex) {
        // Pick a remaining element...
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex -= 1;
        // And swap it with the current element.
        temporaryValue = array[currentIndex];
        array[currentIndex] = array[randomIndex];
        array[randomIndex] = temporaryValue;
      }
      return array;
    }
    /***********************/
    const colorsArray = [GESSO,CANAPA,CACAO,CENERE,LAVAGNA,GESSO,CANAPA,CACAO,CENERE,LAVAGNA,GESSO,CANAPA,CACAO,CENERE,LAVAGNA,GESSO,CANAPA,CACAO,CENERE,LAVAGNA]

    function init(){

      let tileId = 0
      $("span[data-original='true']").each(function() {
        let columnNumber = 0
        const generateElement = () => $("<span></span>")
                                      .attr("columnNumber",columnNumber++)
                                      .attr("data-color",tileId)
                                      .text("⬢")
        for(let i=1; i<=COLUMNS; i++){
          $(this).append(generateElement())
          tileId++
        }
      })
      multiplyColumns()
      multiplyColumns()
      multiplyRows()
      colorize()
    }

    function multiplyColumns(){
      $(".hexrow").each(function() {
        const clonedSpan = $(this).children("span[data-original='true']").clone().attr("data-original",false)
        $(this).append(clonedSpan)
        $(this).append(clonedSpan.clone())
      })
    }
    function multiplyRows(){
      $("div.wrapper[data-original='true']").each(function() {
        const rows = $(this).clone().attr("data-original",false)
        rows.find("*[data-original='true']").attr("data-original",false)
        $("body").append(rows)
      })
    }
    function colorize(){
      shuffle(colorsArray)
      drawColors()
    }
    function drawColors(){
      $("*[data-color]").each(function() {
      const thisColor = $(this).attr("data-color")
      $(this).css("color",colorsArray[thisColor])
      })
    }
  </script>
</head>
<body onload="init()">
  <div class="controls">
    <button type="button" class="btn btn-light" onclick="colorize()">Randomize</button>
    <!-- Button trigger modal -->
    <button type="button" class="btn btn-light" data-toggle="modal" data-target="#changePatternModal">
      Change pattern
    </button>

  </div>
  <div data-original="true" class="wrapper">
    <div class="hexrow hexrowOdd"><span data-original="true"></span></div>
    <div class="hexrow hexrowEven"><span data-original="true"></span></div>
    <div class="hexrow hexrowOdd"><span data-original="true"></span></div>
    <div class="hexrow hexrowEven"><span data-original="true"></span></div>
  </div>


  <!-- Modal -->
  <div class="modal fade" id="changePatternModal" tabindex="-1" role="dialog" aria-labelledby="changePatternModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="changePatternModalLabel">Change pattern</h5>
        </div>
        <div class="modal-body">
          <div data-original="false " class="wrapper">
            <div class="hexrow hexrowOdd"><span data-original="false"><span columnnumber="0" data-color="0" style="color: var(--GESSO);">⬢</span><span columnnumber="1" data-color="1" style="color: var(--CANAPA);">⬢</span><span columnnumber="2" data-color="2" style="color: var(--LAVAGNA);">⬢</span><span columnnumber="3" data-color="3" style="color: var(--CACAO);">⬢</span><span columnnumber="4" data-color="4" style="color: var(--CENERE);">⬢</span></span></div>
            <div class="hexrow hexrowEven"><span data-original="false"><span columnnumber="0" data-color="5" style="color: var(--CANAPA);">⬢</span><span columnnumber="1" data-color="6" style="color: var(--GESSO);">⬢</span><span columnnumber="2" data-color="7" style="color: var(--CENERE);">⬢</span><span columnnumber="3" data-color="8" style="color: var(--CACAO);">⬢</span><span columnnumber="4" data-color="9" style="color: var(--CENERE);">⬢</span></span></div>
            <div class="hexrow hexrowOdd"><span data-original="false"><span columnnumber="0" data-color="10" style="color: var(--CANAPA);">⬢</span><span columnnumber="1" data-color="11" style="color: var(--LAVAGNA);">⬢</span><span columnnumber="2" data-color="12" style="color: var(--CENERE);">⬢</span><span columnnumber="3" data-color="13" style="color: var(--GESSO);">⬢</span><span columnnumber="4" data-color="14" style="color: var(--GESSO);">⬢</span></span></div>
            <div class="hexrow hexrowEven"><span data-original="false"><span columnnumber="0" data-color="15" style="color: var(--CANAPA);">⬢</span><span columnnumber="1" data-color="16" style="color: var(--CACAO);">⬢</span><span columnnumber="2" data-color="17" style="color: var(--LAVAGNA);">⬢</span><span columnnumber="3" data-color="18" style="color: var(--LAVAGNA);">⬢</span><span columnnumber="4" data-color="19" style="color: var(--CACAO);">⬢</span></span></div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
